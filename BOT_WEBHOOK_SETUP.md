# ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Telegram –±–æ—Ç–æ–º

## üìã –û–±–∑–æ—Ä

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è CRM —Å Telegram –±–æ—Ç–æ–º –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞–º –æ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞—Ö –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –¥–∞—Ç –≤—Å—Ç—Ä–µ—á.

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Secrets

### Production Secrets
–î–æ–±–∞–≤—å—Ç–µ –≤ GitHub Secrets (Settings ‚Üí Secrets and variables ‚Üí Actions):

```bash
BOT_WEBHOOK_URL=http://your-bot-server:8080
WEBHOOK_TOKEN=your_webhook_secret_token
```

### Staging Secrets
```bash
STAGING_BOT_WEBHOOK_URL=http://your-staging-bot-server:8080
STAGING_WEBHOOK_TOKEN=your_staging_webhook_secret_token
```

## üöÄ –ß—Ç–æ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

### ‚úÖ CI/CD Workflows
- **deploy.yml** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ production
- **manual-deploy.yml** - —Ä—É—á–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ staging/production

### ‚úÖ Docker Compose
- **docker-compose.prod.yml** - –ø–µ—Ä–µ–¥–∞—á–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ production –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- **docker-compose.staging.yml** - –ø–µ—Ä–µ–¥–∞—á–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ staging –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

### ‚úÖ CRM Backend
- **DirectorNotificationService** - —Å–µ—Ä–≤–∏—Å –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã–∑–æ–≤—ã** –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–æ–≤

## üì° –§–æ—Ä–º–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞
```json
POST /webhook/new-order
{
  "orderId": 123,
  "city": "–ú–æ—Å–∫–≤–∞",
  "dateMeeting": "2025-01-15T10:30:00.000Z",
  "token": "your_webhook_secret_token"
}
```

### –ü–µ—Ä–µ–Ω–æ—Å –¥–∞—Ç—ã
```json
POST /webhook/order-update
{
  "orderId": 123,
  "newDate": "2025-01-15T14:00:00.000Z",
  "city": "–ú–æ—Å–∫–≤–∞",
  "token": "your_webhook_secret_token"
}
```

## üîÑ –¢–æ—á–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

CRM –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ª—É—á–∞—è—Ö:

1. **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –∏–∑ –∑–≤–æ–Ω–∫–∞** (`POST /api/orders/from-call`)
2. **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –∏–∑ —á–∞—Ç–∞ –ê–≤–∏—Ç–æ** (`POST /api/orders/from-chat`)
3. **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞** (`POST /api/orders`)
4. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞—Ç—ã –≤—Å—Ç—Ä–µ—á–∏** (`PUT /api/orders/:id`)

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ CRM
echo $BOT_WEBHOOK_URL
echo $WEBHOOK_TOKEN
```

### 2. –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞
–°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ —á–µ—Ä–µ–∑ CRM –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
docker-compose logs -f backend | grep "—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ"
```

### 3. –¢–µ—Å—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞—Ç—ã
–ò–∑–º–µ–Ω–∏—Ç–µ –¥–∞—Ç—É –≤—Å—Ç—Ä–µ—á–∏ –≤ –∑–∞–∫–∞–∑–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ CRM
```bash
# –õ–æ–≥–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
docker-compose logs backend | grep -E "(—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ|webhook|bot)"

# –§–∞–π–ª—ã –ª–æ–≥–æ–≤
tail -f logs/combined.log | grep -E "(DirectorNotification|webhook)"
```

### Health Check
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞
curl -f http://your-bot-server:8080/health
```

## üö® Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è
**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
2. –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –±–æ—Ç–∞ –ø–æ URL
3. –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ WEBHOOK_TOKEN
4. –õ–æ–≥–∏ CRM –Ω–∞ –æ—à–∏–±–∫–∏

### –ü—Ä–æ–±–ª–µ–º–∞: 401 Unauthorized
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ WEBHOOK_TOKEN –≤ CRM –∏ –±–æ—Ç–µ

### –ü—Ä–æ–±–ª–µ–º–∞: 404 Director not found
**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤ —Ç–∞–±–ª–∏—Ü–µ `director` –µ—Å—Ç—å –∑–∞–ø–∏—Å—å —Å –Ω—É–∂–Ω—ã–º –≥–æ—Ä–æ–¥–æ–º –∏ tg_id

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [DirectorNotificationService](../backend/src/services/directorNotificationService.ts)
- [Order Controller](../backend/src/controllers/orderController.ts)
- [CI/CD Guide](./docs/cicd-guide.md)

---

**üéâ –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ GitHub Secrets –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏!**
